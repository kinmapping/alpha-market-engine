# 自動売買システム 要件定義

## 目的
GMOコイン現物の ticker/板/約定データをリアルタイムで取り込み、シンプルな売買ロジックで自動発注する bot を構築する。FastAPI で運用監視の入口を提供し、24 時間止めずに稼働させられる最小構成を得る。
取引所と安全につながって、低遅延で意思決定して、確実に注文を行う。

## スコープ
- 対象取引所：GMOコイン（現物/スポット）
- データ取得：WebSocket（ticker, orderbooks, trades）
- 発注：REST（market/limit/stop）
- 実装：Python、docker-compose 複数コンテナ（bot / FastAPI / PostgreSQL）
- 稼働：24/7 前提、再接続と例外ハンドリングを持つ

## 機能要件
- WebSocket を購読し、価格・板・約定を受信し続けること
- 売買ロジックでシグナルを判定し、REST で発注・取消できること
- 約定イベントを受け取り、DB に約定・発注ログを記録すること
- FastAPI で監視用エンドポイント（health, bot status, log 参照）を提供すること
- bot を FastAPI と独立稼働させ、API 再起動が bot を止めないこと

## 非機能要件・制約
- 再接続戦略：WS/REST の失敗時に待機→再試行するリトライを実装
- ロギング：stdout と PostgreSQL に時系列で保存、タイムスタンプ・side・price・size・orderId を含む
- 運用性：docker-compose で再現可能なローカル/本番環境。最低限のメトリクス/ログ確認手段を持つ
- セキュリティ：API キーは .env で管理し、リポジトリに含めない

## 非スコープ
- 先物/レバレッジ・HFT・高頻度戦略
- 高度な予測モデルや AI ロジック
- UI/フロントエンドや運用ダッシュボード

## 成果物
- bot・FastAPI・DB を含む docker-compose 一式
- bot の最小売買ロジックとロギング実装
- FastAPI 監視エンドポイント

## 前提・仮定
- 取引所 API キーは取得済みで `.env` に注入できる
- 対象銘柄は BTC/JPY をデフォルトとし、設定で変更可能にする

## オープンクエスチョン
- 売買ロジックの初期ルール（MA 以外の条件や閾値）はどこまで固定するか
- ログの保持期間やアーカイブ方針は必要か
- 運用通知（Slack/メール）の要否はあるか
